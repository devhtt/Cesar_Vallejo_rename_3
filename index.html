<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprende Lenguaje de Señas - UCV</title>
    <link rel="icon" type="image/png" href="ucv.png">
    <link rel="stylesheet" href="styles.css">
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(46, 125, 50, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 1000;
            display: none;
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, 20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
    </style>
</head>
<body>
    <header>
        <nav class="top-nav">
            <div class="container">
                <div class="logo-container">
                    <img src="ucv.png" alt="Logo UCV" class="logo">
                    <span class="university-name">Universidad César Vallejo</span>
                </div>
                <!-- Eliminado el div top-actions que contenía el botón de cerrar sesión -->
            </div>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <div class="hero-grid">
                        <div class="hero-text">
                            <h1>
                                <span class="blue">Cuando el</span>
                                <span class="red">lenguaje de señas</span><br>
                                <span class="yellow">se une con la</span>
                                <span class="green">innovación,</span><br>
                                <span class="blue">la comunicación</span>
                                <span class="signature">se transforma.</span>
                            </h1>
                        </div>
                        <div class="hero-login" id="loginSection">
                            <!-- panel de inicio de sesión alineado a la derecha -->
                            <div class="login-panel">
                                <div class="login-card">
                                    <h2>Iniciar sesión</h2>
                                    <p style="margin:8px 0 12px;color:#333">Inicia sesión usando tu cuenta de Google</p>
                                    <div class="or" style="display:none">o</div>
                                    <div id="googleSignContainer">
                                        <div id="g_id_onload"
                                             data-client_id="903625348841-bmkhrd53eok4bgo2j4pfhrijck43pgdb.apps.googleusercontent.com"
                                             data-callback="handleCredentialResponse"
                                             data-auto_prompt="false"
                                             data-auto_select="true"
                                             data-ux_mode="popup"
                                             data-context="signin">
                                        </div>
                                        <div class="g_id_signin" data-type="standard"></div>
                                    </div>
                                    <div style="margin-top:10px;">
                                        <button id="btnGuest" class="btn" type="button" onclick="location.href='seleccion.html'">Iniciar como invitado</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Panel de perfil si ya está logueado -->
                        <div class="hero-login" id="profileSection" style="display:none">
                            <div class="login-panel">
                                <div class="login-card">
                                    <h2>Bienvenido</h2>
                                    <div style="text-align:center;margin:16px 0">
                                        <img id="profilePicture" src="" alt="Foto" style="width:80px;height:80px;border-radius:50%;margin-bottom:12px">
                                        <p style="margin:8px 0;font-size:1.1rem;font-weight:600" id="profileName">Usuario</p>
                                        <p style="margin:4px 0;color:#666;font-size:0.9rem" id="profileEmail">email@example.com</p>
                                    </div>
                                    <div style="margin-top:16px">
                                        <button id="btnContinue" class="btn" type="button" onclick="location.href='seleccion.html'" style="width:100%">Continuar</button>
                                        <button id="btnLogout" class="btn" type="button" style="width:100%;margin-top:8px;background:#f3f3f3;color:#222;border-color:#ccc">Cerrar sesión</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
             </div>
         </section>
    </main>

    <div id="notification" class="notification">Sesión guardada</div>

    <script>
        // Guardar usuario y navegar a seleccion.html
        function saveUserAndNavigate(){
            const user = {
                id: 'user_' + Date.now(),
                name: 'Usuario',
                email: 'usuario@gmail.com',
                picture: 'https://ui-avatars.com/api/?name=U&background=4285F4&color=fff',
                loginDate: new Date().toISOString()
            };
            localStorage.setItem('currentUser', JSON.stringify(user));
            showNotification('Sesión guardada');
            setTimeout(() => location.href = 'seleccion.html', 500);
        }

        function handleCredentialResponse(response){
            try {
                const token = response.credential;
                const payload = JSON.parse(atob(token.split('.')[1]));
                const user = {
                    id: payload.sub,
                    name: payload.name,
                    email: payload.email,
                    picture: payload.picture,
                    loginDate: new Date().toISOString()
                };
                localStorage.setItem('currentUser', JSON.stringify(user));
                showNotification('Sesión iniciada con Google');
                updateUI();
            } catch(e) {
                console.error('Error:', e);
                showNotification('Error al iniciar sesión');
            }
        }

        function showNotification(message){
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.style.display = 'block';
            setTimeout(() => notif.style.display = 'none', 2000);
        }

        function updateUI(){
            const stored = localStorage.getItem('currentUser');
            if (stored) {
                try {
                    const user = JSON.parse(stored);
                    document.getElementById('loginSection').style.display = 'none';
                    document.getElementById('profileSection').style.display = 'block';
                    document.getElementById('profilePicture').src = user.picture;
                    document.getElementById('profileName').textContent = user.name;
                    document.getElementById('profileEmail').textContent = user.email;
                } catch(e) {
                    console.error('Error:', e);
                }
            } else {
                document.getElementById('loginSection').style.display = 'block';
                document.getElementById('profileSection').style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const btnLogout = document.getElementById('btnLogout');
            if (btnLogout) {
                btnLogout.addEventListener('click', () => {
                    localStorage.removeItem('currentUser');
                    showNotification('Sesión cerrada');
                    updateUI();
                });
            }
        });

        window.addEventListener('load', () => {
            updateUI();
        });
    </script>
</body>
</html>
